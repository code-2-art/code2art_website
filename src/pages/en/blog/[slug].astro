---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { getCollection, render } from 'astro:content';
import { t, getLocalePath } from '../../../i18n/ui';
import type { Lang } from '../../../i18n/ui';

const lang: Lang = 'en';

export async function getStaticPaths() {
  const posts = await getCollection('tutorials', ({ filePath }) => filePath.includes('/en/'));
  return posts.map((post) => ({ params: { slug: post.data.slug }, props: { post } }));
}

const { post } = Astro.props;
const { Content } = await render(post);
const title = `${post.data.title} | TechArt`;
---
<BaseLayout title={title} description={post.data.summary ?? ''} ogImage={post.data.coverUrl ?? '/og-cover.jpg'} lang={lang} altPath={`blog/${post.data.slug}`}>
  <article class="pt-28 pb-16">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-3xl">
      <header class="mb-8">
        <h1 class="text-3xl md:text-4xl font-extrabold">{post.data.title}</h1>
        <div class="mt-4 flex items-center gap-4 text-slate-600">
          {post.data.authorAvatarUrl && <img src={post.data.authorAvatarUrl} alt={post.data.author} class="w-10 h-10 rounded-full" />}
          <div>
            <div class="font-medium">{post.data.author}</div>
            <div class="text-sm">{post.data.publishedAt?.slice(0,10)}</div>
          </div>
        </div>
        {post.data.coverUrl && <img src={post.data.coverUrl} alt={post.data.title} class="mt-6 rounded-xl" />}
      </header>

      <div class="prose prose-slate max-w-none">
        <Content />
      </div>

      <footer class="mt-12 text-slate-500 border-t pt-6">
        <p>{t(lang, 'article.publishedAt')} {post.data.publishedAt?.slice(0,10) ?? t(lang, 'article.unknownTime')}</p>
      </footer>
    </div>
  </article>
</BaseLayout>
